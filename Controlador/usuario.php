<?phprequire_once "../Modelo/autoload.php";if($_POST){    $option = $_GET['op'] ?? '';    $id_usuario = $_POST['user'] ?? '';    $user_data = array("cliente" => trim(ucwords(strtolower($_POST['client']?? ''))), "email" => trim(strtolower($_POST['email']?? '')), "password" => $_POST['password']?? '');    $response = [];    $card = '';    $hostUser ="https://blezracing.com/wp-json/validate-user/v1/user/".$id_usuario;    $tokenUser = "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJodHRwczpcL1wvd3d3LmJsZXpyYWNpbmcuY29tIiwiaWF0IjoxNjQ1MzE4MzcwLCJuYmYiOjE2NDUzMTgzNzAsImV4cCI6MTk2MDY3ODM3MCwiZGF0YSI6eyJ1c2VyIjp7ImlkIjoiMSJ9fX0.P_ms9-2XPuai8YI7CksSADrIZek-doruXNu2Xhr2aKE";    $tokenAfiliate = "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJodHRwczpcL1wvYWZpbGlhZG9zLmJsZXpyYWNpbmcuY29tIiwiaWF0IjoxNjQ1MzIzNTM0LCJuYmYiOjE2NDUzMjM1MzQsImV4cCI6MTk2MDY4MzUzNCwiZGF0YSI6eyJ1c2VyIjp7ImlkIjoiMSJ9fX0.IQb8XN6vkM9syMC0B4q9rsoEuWiw_ImJTZV2Pfap3h8";    $hostAfiliate = "https://afiliados.blezracing.com/wp-json/afiliados-listing/v1/post/1891";    switch ($option)    {        case 1:            $dataUser = validate_api_rest_wp($tokenUser, $hostUser);            if(empty($dataUser))            {                $response = array("type_msg" => "error", "msg" => "El usuario ingresado no existe en el sistema", "title" => "Sistema Blez");                echo json_encode($response);            }else{                $name_user =  $dataUser[0]['display_name'];                $dataListing = validate_api_rest_wp($tokenAfiliate, $hostAfiliate);                if(empty($dataListing))                {                    $response = array("type_msg" => "error", "msg" => "El Usuario ingresado no existe en el sistema", "title" => "Sistema Blez");                    echo json_encode($response);                }else{                    $dataListing = (array) $dataListing[0]['meta_value'];                    $dataListing = $dataListing[0];                    $cad = explode('"',$dataListing);                    $image = array();                    foreach ($cad as $value)                    {                        if(strncasecmp($value, 'http', 4) === 0)                        {                            $image[] = $value;                        }                    }                }                foreach ($image as $img) {                $card .= '<div class="val-box">                            <img src="'.$img.'" alt="Imagen">                          </div>';              }                $table =' <table class="table">                <thead>                    <tr>                        <td>Nombre</td>                        <td>Afiliado</td>                        <td>Estado</td>                        <td>Marca</td>                    </tr>                </thead>                <tbody>                    <tr>                        <td class="people-de">                                <h2 >'.$name_user.'</h2>                                <p>Hincha Blez</p>                        </td>                        <td class="active">                            <p>Activo</p>                        </td>                        <td class="active">                            <p>Registrado</p>                        </td>                        <td class="edit">                            <a href="#">Blez Racing</a>                        </td>                    </tr>                </tbody>            </table>';                $response = array("table" => $table, "card" => $card);                echo json_encode($response);            }            break;        case 2:                $objUser = new Usuario();                $resp_add_user = $objUser->add_user($user_data);                if($resp_add_user == 0 )                {                    $response = array("type_msg" => "info", "msg" => "Debe llenar todos los campos", "title" => "Sistema Blez");                }elseif($resp_add_user > 0)                {                    $response = array("type_msg" => "success", "msg" => "Usuario agregado al sistema con éxito", "title" => "Sistema Blez");                }else{                    $response = array("type_msg" => "error", "msg" => "Ocurrió inesperado, intente de nuevo más tarde", "title" => "Sistema Blez");                }                echo json_encode($response);            break;    }}function validate_api_rest_wp($token, $host){    $header = array(        'Content-type:application/json',        'Authorization:Bearer' . $token    );    $ch = curl_init($host);    curl_setopt($ch, CURLOPT_HTTPHEADER, $header);    curl_setopt($ch,CURLOPT_CUSTOMREQUEST,'GET');    curl_setopt($ch, CURLOPT_RETURNTRANSFER,1);    $result = curl_exec($ch);    $resultResponse = json_decode($result,true);    $resultResponse = (array) $resultResponse;    curl_close($ch);    if(isset($resultResponse['data']['status']) == 404)    {        $response = 2;    }else{        $response = $resultResponse;    }    return $response;}?>